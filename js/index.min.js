function editEmbeddedStyle(e){var t=8*e.length;document.getElementsByTagName("style")[0].innerHTML=".np-current:after {width: "+t+"px;height: "+t+"px;margin-left: -"+t+"px;}"}function synthSetting(e){switch(e){case"square":theSynth.dispose(),theSynth=new Tone.MonoSynth(squareSynthPresets).toMaster();case"sine":theSynth.dispose(),theSynth=new Tone.MonoSynth(sineSynthPresets).toMaster();case"saw":theSynth.dispose(),theSynth=new Tone.MonoSynth(sawSynthPresets).toMaster();case"chord":theSynth.dispose(),theSynth=new Tone.PolySynth(2,Tone.MonoSynth).toMaster(),theSynth.set(chordSynthPresets)}}function presetMaker(e){switch(+e){case 1:synthSetting("square"),synthPitch=4,synthType=1,noteLength="8n",pingPong.wet.rampTo(.1,.5),feedbackDelay.wet.rampTo(0,.5),syncedDelay.wet.rampTo(0,.5),vibrato.wet.rampTo(0,.5),chorus.wet.rampTo(0,.5),freeverb.wet.rampTo(.1,.5);break;case 2:synthSetting("sine"),synthPitch=5,synthType=2,noteLength="4n",pingPong.wet.rampTo(.05,.5),feedbackDelay.wet.rampTo(0,.5),syncedDelay.wet.rampTo(0,.5),vibrato.wet.rampTo(.9,.5),chorus.wet.rampTo(0,.5),freeverb.wet.rampTo(.05,.5);break;case 3:synthSetting("saw"),synthPitch=3,synthType=3,noteLength="2n",pingPong.wet.rampTo(0,.5),feedbackDelay.wet.rampTo(.01,.5),syncedDelay.wet.rampTo(0,.5),vibrato.wet.rampTo(.9,.5),chorus.wet.rampTo(.5,.5),freeverb.wet.rampTo(.01,.5);break;case 4:synthSetting("chord"),synthPitch=3,synthType=4,noteLength="4n",pingPong.wet.rampTo(0,.5),feedbackDelay.wet.rampTo(0,.5),syncedDelay.wet.rampTo(.1,.5),vibrato.wet.rampTo(.3,.5),chorus.wet.rampTo(.2,.5),freeverb.wet.rampTo(.05,.5)}}var $bodyText=$(".body-text").html();localStorage.welcomeMessage||$("#welcome-container, #welcome-overlay").show(),$("#welcome-box-cross, #click-to-close, #welcome-overlay").on("click",function(){localStorage.clear(),$("#welcome-container, #welcome-overlay").hide(),localStorage.setItem("welcomeMessage","seen")}),$("#info-button").on("click",function(){localStorage.clear(),$("#welcome-container, #welcome-overlay").show()});var triggerFunction=function(){$(".tone-trigger").each(function(){new Waypoint({element:this,handler:function(e){0==$(this.element).hasClass("np-current")&&($(".tone-trigger").removeClass("np-current"),$(this.element).addClass("np-current"),playTone())},offset:"50%",group:".tone-trigger"})})},searchWord=function(e){$(".tone-trigger").removeClass("np-current");var t=new RegExp(e.trim(),"gi"),n=$bodyText.replace(t,"<span class='tone-trigger'>$&</span>");$(".body-text").html(n),triggerFunction()};$(".fa-search, #search-button-cross").on("click",function(e){$(".search").toggleClass("open")}),$("#search-button").on("click",function(){if($("#search-field").val()){var e=new RegExp($("#search-field").val(),"g");e.test($bodyText)&&$("#search-field").val().length>1?(searchWord($("#search-field").val()),editEmbeddedStyle($("#search-field").val()),$("#search-field").attr("placeholder",$("#search-field").val()),$("#search-field").val(""),$("#search-field").removeClass("red-background"),$("#search-field").addClass("green-background")):$("#search-field").addClass("red-background")}}),$("#search-field").on("focus",function(){$(this).val(""),$(this).removeClass("red-background green-background")}),$(".fa-pencil").on("click",function(e){if($(".edit").hasClass("open"))$(".edit").removeClass("open"),$(".body-text").html($("textarea").val()),$("textarea").remove(),$(".body-text").show(),$bodyText=$(".body-text").html();else{$(".edit").addClass("open");var t=$("<textarea>").text($bodyText);$(".body-text").hide(),$(".container").append(t)}}),$("#save-button").on("click",function(e){$(".edit").removeClass("open"),$(".body-text").html($("textarea").val()),$("textarea").remove(),$(".body-text").show(),$bodyText=$(".body-text").html()}),$("#volume-button").on("click",function(){$(this).hasClass("fa-volume-up")?($(this).removeClass("fa-volume-up"),$(this).addClass("fa-volume-down"),Tone.Master.mute=!0):($(this).removeClass("fa-volume-down"),$(this).addClass("fa-volume-up"),Tone.Master.mute=!1)}),$("#audio-button, #audio-button-cross").on("click",function(){$(".audio-preset").toggleClass("open")}),$(".preset").on("click",function(){$(".preset").removeClass("preset-on"),$(this).addClass("preset-on"),presetMaker($(this).attr("id").slice(7))});var synthPitch=4,synthType=1,noteLength="8n",squareSynthPresets={frequency:"C4",detune:0,oscillator:{type:"square"},filter:{Q:1,type:"lowpass",rolloff:-24},envelope:{attack:.5,decay:.2,sustain:.3,release:1.5},filterEnvelope:{attack:.5,decay:.9,sustain:.1,release:1,baseFrequency:200,octaves:5,exponent:5}},sineSynthPresets={frequency:"C4",detune:0,oscillator:{type:"sine"},filter:{Q:1,type:"lowpass",rolloff:-24},envelope:{attack:.01,decay:.2,sustain:.3,release:1.5},filterEnvelope:{attack:.01,decay:.9,sustain:.5,release:1,baseFrequency:200,octaves:5,exponent:5},volume:3.5},sawSynthPresets={frequency:"C4",detune:0,oscillator:{type:"sawtooth"},filter:{Q:1,type:"lowpass",rolloff:-24},envelope:{attack:.005,decay:.2,sustain:.3,release:1.5},filterEnvelope:{attack:.03,decay:.9,sustain:.3,release:1,baseFrequency:220,octaves:5,exponent:5},volume:1.5},chordSynthPresets={frequency:"C4",detune:0,oscillator:{type:"square"},filter:{Q:1,type:"lowpass",rolloff:-24},envelope:{attack:.4,decay:.2,sustain:.3,release:1.5},filterEnvelope:{attack:.4,decay:.9,sustain:.3,release:1,baseFrequency:320,octaves:5,exponent:5},volume:.5},theSynth=new Tone.MonoSynth(squareSynthPresets).toMaster(),playTone=function(){var e=["A","B","C","D","E","F","G"],t=e[Math.floor(7*Math.random())];switch(synthType){case 1:theSynth.triggerAttackRelease(t+synthPitch,noteLength);break;case 2:theSynth.triggerAttackRelease(t+synthPitch,noteLength);break;case 3:theSynth.triggerAttackRelease(t+synthPitch,noteLength);break;case 4:theSynth.triggerAttackRelease(chordMapper(t,synthPitch),noteLength)}},chordMapper=function(e,t){switch(e){case"A":return["A"+t,"E"+t];case"B":return["B"+t,"Fb"+t];case"C":return["C"+t,"G"+t];case"D":return["D"+t,"A"+(+t+1).toString()];case"E":return["E"+t,"B"+(+t+1).toString()];case"F":return["F"+t,"C"+(+t+1).toString()];case"G":return["G"+t,"D"+(+t+1).toString()];default:return}},vol1=new Tone.Volume((-16)),vol2=new Tone.Volume(4),freeverb=new Tone.Freeverb({roomSize:.9,dampening:5e3,wet:.1}),vibrato=new Tone.Vibrato({frequency:.8,depth:.6,type:"sine",wet:0}),pingPong=new Tone.PingPongDelay({delayTime:"6n",feedback:.2,wet:.1}),feedbackDelay=new Tone.FeedbackDelay({delayTime:"4n",feedback:.4,wet:0}),syncedDelay=new Tone.PingPongDelay({delayTime:"8n",feedback:.5,wet:0}),chorus=new Tone.Chorus({frequency:1.2,delayTime:3.5,depth:.4,feedback:.1,type:"sine",spread:180,wet:0}),comp=new Tone.Compressor((-30),5),limiter=new Tone.Limiter((-2));!function(){/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)?Tone.Master.chain(comp,limiter):Tone.Master.chain(vol1,freeverb,pingPong,feedbackDelay,syncedDelay,vibrato,chorus,comp,vol2,limiter)}();
